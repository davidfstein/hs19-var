<html>
  <head>
    <script src="https://aframe.io/releases/0.9.2/aframe.min.js"></script>
    <!-- <script src="https://rawgit.com/protyze/aframe-curve-component/master/dist/aframe-curve-component.min.js"></script> -->
    <!-- <script src="https://rawgit.com/protyze/aframe-alongpath-component/master/dist/aframe-alongpath-component.min.js"></script> -->
    <script src="https://unpkg.com/aframe-curve-component/dist/aframe-curve-component.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@3.0.3/dist/aframe-event-set-component.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.0.1/dist/aframe-extras.min.js"></script>
    <script>
      AFRAME.registerComponent('hover-text', {
  schema: {
    value: {default: ''}
  },

  init: function () {
    var data = this.data;
    var el = this.el;

    el.addEventListener('mouseenter', function () {
      el.setAttribute('text', {content: data.content});
    });
  }
});
    </script>
  </head>
  <body>

    <a-scene background="color: #AAB" fog="type: linear; color: #AAB; far: 30; near: 0">
        <a-curve id="track1"></a-curve>
        <a-draw-curve curveref="#track1" material="shader: line; color: blue;"></a-draw-curve>
        <a-entity position="0 0 0" id="cells" rotation="0 360 0"></a-entity>
        <a-sky></a-sky>
<!--         <a-box position="0 0 0" rotation="0 45 0" color="#4CC3D9" change-color-on-hover="color: red"></a-box> -->
        <a-camera zoom="5" position="0 0 0" look-controls wasd-controls="acceleration: 5">
          <a-entity cursor="showLine: true; near: 0; far: 1"
                    position="0.000 0.000 -0.1"
                    geometry="primitive: ring; radiusInner: 0.0004; radiusOuter: 0.0008"
                    material="color: black; shader: flat"
                    cursor-submit></a-entity>
<!--           <a-cursor showline="true" rayorigin="mouse"></a-cursor> -->
        </a-camera>
    </a-scene>
    <script>
        const getCurvePoints = () => {
          return fetch('data/curves.json')
            .then(response => response.text())
            .then(text => {
              const coords = JSON.parse(text);
              const curvePoints = [];
              coords.forEach((coord, _) => {
                  const curvePoint = `<a-curve-point position="${coord.x} ${coord.y} ${coord.z}"></a-curve-point>`;
                  curvePoints.push(curvePoint);
              });
              return curvePoints;
            });
        }

        const getCells = () => {
          return fetch('data/cells2.json')
          .then(response => response.text())
          .then(text => {
              const cell_points = JSON.parse(text);
              const cells = [];
              cell_points.forEach((cell_point, _) => {
                  const stream_cell = `<a-sphere position="${cell_point.x} ${cell_point.y} ${cell_point.z}" color="${cell_point.color1}" hover-text="value: ${cell_point.cell_type}." radius=".001"></a-sphere>`;
                  cells.push(stream_cell);
              })
              return cells;
          });
        }

        getCurvePoints()
          .then((curvePoints) => {
            const curve_el = document.getElementById("track1");
            curve_el.innerHTML = curvePoints.join(" ");
          });

        getCells()
          .then((cells) => {
            const cell_el = document.getElementById("cells");
            cell_el.innerHTML = cells.join(" ");
          });

    </script>
  </body>
</html>
<!-- https://stackoverflow.com/questions/42495751/a-sphere-show-text-on-mouse-over-or-attach-a-text-to-a-sphere -->
<!-- https://stackoverflow.com/questions/45290933/show-text-on-mouse-over-of-a-sphere -->
